\appendix

% \begin{itemize}
%     \item Maxime \ok ? \no ?
%     \item Thierry \ok ? \no ?
%     \item Victor \ok ? \no ?
% \end{itemize}



%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%

\begin{table}[h!]
    \begin{footnotesize}
    \begin{center}
    \begin{tabular}{l|cc:cc:cc}
    \toprule
    Dataset               &   SGD           & SGD \& \tecnameAbrv & Adagrad & Adagrad \& \tecnameAbrv & Adam        & Adam \& \tecnameAbrv \\
    \midrule
    \textbf{ACI         } & 0.36 $\pm$ 0.16 & \textbf{0.18 $\pm$ 0.01} & 0.27 $\pm$ 0.07 & \textbf{0.13 $\pm$ 0.01} & 0.36 $\pm$ 0.16 & 0.17 $\pm$ 0.02 \\ 
    \textbf{compas      } & 0.47 $\pm$ 0.28 & 0.24 $\pm$ 0.01 & 0.60 $\pm$ 0.26 & \textbf{0.08 $\pm$ 0.02} & 0.60 $\pm$ 0.19 & 0.38 $\pm$ 0.12 \\ 
    \textbf{DGK         } \\ 
    \textbf{Forest Cover} & 1.98 $\pm$ 0.01 & \textbf{1.95 $\pm$ 0.01} & 1.98 $\pm$ 0.02 & \textbf{1.40 $\pm$ 0.05} & 1.98 $\pm$ 0.01 & 1.96 $\pm$ 0.01 \\ 
    \textbf{KDD99       } & 3.22 $\pm$ 0.12 & \textbf{0.30 $\pm$ 0.07} & 3.10 $\pm$ 0.13 & \textbf{0.17 $\pm$ 0.02} & 3.15 $\pm$ 0.19 & \textbf{0.55 $\pm$ 0.07} \\ 

    \bottomrule
    \end{tabular}
    \caption{Results with mlp and batch of 32}
    \label{tab:resultsMLP32}
    \end{center}
    \end{footnotesize}
\end{table}


\begin{table}[h!]
    \begin{footnotesize}
    \begin{center}
    \begin{tabular}{l|cc:cc:cc}
    \toprule
    Dataset               &   SGD           & SGD \& \tecnameAbrv & Adagrad & Adagrad \& \tecnameAbrv & Adam        & Adam \& \tecnameAbrv \\
    \midrule
    \textbf{ACI         } & 0.37 $\pm$ 0.07 & \textbf{0.13 $\pm$ 0.01} & 0.42 $\pm$ 0.07 & \textbf{0.13 $\pm$ 0.01} & 0.42 $\pm$ 0.07 & \textbf{0.13 $\pm$ 0.01} \\ 
    \textbf{compas      } & 0.69 $\pm$ 0.27 & \textbf{0.06 $\pm$ 0.01} & 0.65 $\pm$ 0.24 & \textbf{0.01 $\pm$ 0.01} & 0.87 $\pm$ 0.47 & \textbf{0.05 $\pm$ 0.01} \\ 
    \textbf{DGK         } \\ 
    \textbf{Forest Cover} & 2.03 $\pm$ 0.03 & \textbf{1.14 $\pm$ 0.01} & 2.02 $\pm$ 0.03 & \textbf{1.04 $\pm$ 0.01} & 2.01 $\pm$ 0.04 & \textbf{1.06 $\pm$ 0.01} \\ 
    \textbf{KDD99       } & 3.24 $\pm$ 0.06 & \textbf{0.06 $\pm$ 0.01} & 3.19 $\pm$ 0.05 & \textbf{0.05 $\pm$ 0.01} & 3.22 $\pm$ 0.06 & \textbf{0.06 $\pm$ 0.01} \\ 

    \bottomrule
    \end{tabular}
    \caption{Results with resnet and batch of 32}
    \label{tab:resultsRESNET32}
    \end{center}
    \end{footnotesize}
\end{table}


\begin{table}[h!]
    \begin{footnotesize}
    \begin{center}
    \begin{tabular}{l|cc:cc:cc}
    \toprule
    Dataset               &   SGD           & SGD \& \tecnameAbrv & Adagrad & Adagrad \& \tecnameAbrv & Adam        & Adam \& \tecnameAbrv \\
    \midrule
    \textbf{ACI         } & 0.36 $\pm$ 0.17 & \textbf{0.18 $\pm$ 0.01} & 0.30 $\pm$ 0.09 & \textbf{0.13 $\pm$ 0.01} & 0.30 $\pm$ 0.14 & 0.19 $\pm$ 0.08 \\ 
    \textbf{compas      } & 0.52 $\pm$ 0.46 & 0.25 $\pm$ 0.01 & 0.57 $\pm$ 0.27 & \textbf{0.12 $\pm$ 0.05} & 0.67 $\pm$ 0.36 & 0.49 $\pm$ 0.25 \\ 
    \textbf{DGK         } & 0.21 $\pm$ 0.06 & \textbf{0.11 $\pm$ 0.01} & 0.19 $\pm$ 0.06 & \textbf{0.11 $\pm$ 0.01} & 0.20 $\pm$ 0.08 & 0.14 $\pm$ 0.04 \\ 
    \textbf{Forest Cover} & 1.99 $\pm$ 0.02 & 1.97 $\pm$ 0.01 & 1.97 $\pm$ 0.01 & \textbf{1.52 $\pm$ 0.09} & 1.98 $\pm$ 0.01 & 1.96 $\pm$ 0.01 \\ 
    \textbf{KDD99       } & 3.09 $\pm$ 0.18 & \textbf{0.38 $\pm$ 0.08} & 3.12 $\pm$ 0.21 & \textbf{0.17 $\pm$ 0.03} & 3.36 $\pm$ 0.12 & \textbf{0.68 $\pm$ 0.16} \\ 

    \bottomrule
    \end{tabular}
    \caption{Results with mlp and batch of 64}
    \label{tab:resultsMLP64}
    \end{center}
    \end{footnotesize}
\end{table}


\begin{table}[h!]
    \begin{footnotesize}
    \begin{center}
    \begin{tabular}{l|cc:cc:cc}
    \toprule
    Dataset               &   SGD           & SGD \& \tecnameAbrv & Adagrad & Adagrad \& \tecnameAbrv & Adam        & Adam \& \tecnameAbrv \\
    \midrule
    \textbf{ACI         } & 0.35 $\pm$ 0.02 & \textbf{0.14 $\pm$ 0.01} & 0.40 $\pm$ 0.11 & \textbf{0.13 $\pm$ 0.01} & 0.47 $\pm$ 0.11 & \textbf{0.13 $\pm$ 0.01} \\ 
    \textbf{compas      } & 0.65 $\pm$ 0.23 & \textbf{0.08 $\pm$ 0.01} & 0.65 $\pm$ 0.31 & \textbf{0.02 $\pm$ 0.01} & 0.59 $\pm$ 0.20 & \textbf{0.06 $\pm$ 0.01} \\ 
    \textbf{DGK         } & 0.27 $\pm$ 0.11 & \textbf{0.12 $\pm$ 0.01} & 0.28 $\pm$ 0.04 & \textbf{0.10 $\pm$ 0.01} & 0.30 $\pm$ 0.13 & \textbf{0.12 $\pm$ 0.01} \\ 
    \textbf{Forest Cover} & 2.02 $\pm$ 0.03 & \textbf{1.29 $\pm$ 0.02} & 2.02 $\pm$ 0.03 & \textbf{1.05 $\pm$ 0.01} & 2.02 $\pm$ 0.03 & \textbf{1.07 $\pm$ 0.01} \\ 
    \textbf{KDD99       } & 3.19 $\pm$ 0.10 & \textbf{0.06 $\pm$ 0.01} & 3.16 $\pm$ 0.08 & \textbf{0.05 $\pm$ 0.01} & 3.23 $\pm$ 0.06 & \textbf{0.06 $\pm$ 0.01} \\ 

    \bottomrule
    \end{tabular}
    \caption{Results with resnet and batch of 64}
    \label{tab:resultsRESNET64}
    \end{center}
    \end{footnotesize}
\end{table}


\begin{table}[h!]
    \begin{footnotesize}
    \begin{center}
    \begin{tabular}{l|cc:cc:cc}
    \toprule
    Dataset               &   SGD           & SGD \& \tecnameAbrv & Adagrad & Adagrad \& \tecnameAbrv & Adam        & Adam \& \tecnameAbrv \\
    \midrule
    \textbf{ACI         } & 0.41 $\pm$ 0.20 & \textbf{0.18 $\pm$ 0.01} & 0.33 $\pm$ 0.18 & \textbf{0.13 $\pm$ 0.01} & 0.30 $\pm$ 0.14 & 0.18 $\pm$ 0.02 \\ 
    \textbf{compas      } & 0.65 $\pm$ 0.19 & \textbf{0.31 $\pm$ 0.03} & 0.56 $\pm$ 0.35 & \textbf{0.12 $\pm$ 0.05} & 0.51 $\pm$ 0.24 & 0.43 $\pm$ 0.19 \\ 
    \textbf{DGK         } \\ 
    \textbf{Forest Cover} & 2.00 $\pm$ 0.02 & 1.98 $\pm$ 0.01 & 1.99 $\pm$ 0.01 & \textbf{1.57 $\pm$ 0.09} & 1.99 $\pm$ 0.02 & 1.97 $\pm$ 0.02 \\ 
    \textbf{KDD99       } & 3.19 $\pm$ 0.14 & \textbf{0.60 $\pm$ 0.19} & 3.27 $\pm$ 0.17 & \textbf{0.16 $\pm$ 0.03} & 3.25 $\pm$ 0.16 & \textbf{0.96 $\pm$ 0.29} \\ 

    \bottomrule
    \end{tabular}
    \caption{Results with mlp and batch of 128}
    \label{tab:resultsMLP128}
    \end{center}
    \end{footnotesize}
\end{table}


\begin{table}[h!]
    \begin{footnotesize}
    \begin{center}
    \begin{tabular}{l|cc:cc:cc}
    \toprule
    Dataset               &   SGD           & SGD \& \tecnameAbrv & Adagrad & Adagrad \& \tecnameAbrv & Adam        & Adam \& \tecnameAbrv \\
    \midrule
    \textbf{ACI         } & 0.78 $\pm$ 0.20 & \textbf{0.14 $\pm$ 0.01} & 0.99 $\pm$ 0.33 & \textbf{0.13 $\pm$ 0.01} & 0.90 $\pm$ 0.22 & \textbf{0.13 $\pm$ 0.01} \\ 
    \textbf{compas      } & 0.69 $\pm$ 0.34 & \textbf{0.11 $\pm$ 0.01} & 0.75 $\pm$ 0.28 & \textbf{0.02 $\pm$ 0.01} & 0.75 $\pm$ 0.53 & \textbf{0.06 $\pm$ 0.01} \\ 
    \textbf{DGK         } \\ 
    \textbf{Forest Cover} & 2.02 $\pm$ 0.03 & \textbf{1.52 $\pm$ 0.03} & 2.01 $\pm$ 0.03 & \textbf{1.03 $\pm$ 0.01} & 2.01 $\pm$ 0.02 & \textbf{1.06 $\pm$ 0.01} \\ 
    \textbf{KDD99       } & 3.18 $\pm$ 0.03 & \textbf{0.07 $\pm$ 0.01} & 3.21 $\pm$ 0.08 & \textbf{0.05 $\pm$ 0.01} & 3.18 $\pm$ 0.07 & \textbf{0.06 $\pm$ 0.01} \\ 

    \bottomrule
    \end{tabular}
    \caption{Results with resnet and batch of 128}
    \label{tab:resultsRESNET128}
    \end{center}
    \end{footnotesize}
\end{table}


\begin{table}[h!]
    \begin{footnotesize}
    \begin{center}
    \begin{tabular}{l|cc:cc:cc}
    \toprule
    Dataset               &   SGD           & SGD \& \tecnameAbrv & Adagrad & Adagrad \& \tecnameAbrv & Adam        & Adam \& \tecnameAbrv \\
    \midrule
    \textbf{ACI         } & 0.68 $\pm$ 0.36 & \textbf{0.19 $\pm$ 0.01} & 0.86 $\pm$ 0.43 & \textbf{0.15 $\pm$ 0.01} & 0.63 $\pm$ 0.43 & 0.42 $\pm$ 0.30 \\ 
    \textbf{compas      } & 0.86 $\pm$ 0.40 & 0.49 $\pm$ 0.15 & 0.57 $\pm$ 0.30 & \textbf{0.20 $\pm$ 0.04} & 0.53 $\pm$ 0.29 & 0.47 $\pm$ 0.24 \\ 
    \textbf{DGK         } \\ 
    \textbf{Forest Cover} & 1.98 $\pm$ 0.02 & 1.97 $\pm$ 0.01 & 1.99 $\pm$ 0.02 & \textbf{1.74 $\pm$ 0.06} & 1.99 $\pm$ 0.02 & 1.97 $\pm$ 0.02 \\ 
    \textbf{KDD99       } & 3.12 $\pm$ 0.18 & \textbf{0.96 $\pm$ 0.22} & 3.11 $\pm$ 0.20 & \textbf{0.19 $\pm$ 0.03} & 3.14 $\pm$ 0.14 & \textbf{1.47 $\pm$ 0.43} \\ 

    \bottomrule
    \end{tabular}
    \caption{Results with mlp and batch of 256}
    \label{tab:resultsMLP256}
    \end{center}
    \end{footnotesize}
\end{table}


\begin{table}[h!]
    \begin{footnotesize}
    \begin{center}
    \begin{tabular}{l|cc:cc:cc}
    \toprule
    Dataset               &   SGD           & SGD \& \tecnameAbrv & Adagrad & Adagrad \& \tecnameAbrv & Adam        & Adam \& \tecnameAbrv \\
    \midrule
    \textbf{ACI         } & 1.00 $\pm$ 0.28 & \textbf{0.14 $\pm$ 0.01} & 1.10 $\pm$ 0.43 & \textbf{0.12 $\pm$ 0.01} & 0.79 $\pm$ 0.18 & \textbf{0.13 $\pm$ 0.01} \\ 
    \textbf{compas      } & 0.73 $\pm$ 0.31 & \textbf{0.17 $\pm$ 0.01} & 0.69 $\pm$ 0.18 & \textbf{0.03 $\pm$ 0.01} & 0.57 $\pm$ 0.17 & \textbf{0.07 $\pm$ 0.01} \\ 
    \textbf{DGK         } \\ 
    \textbf{Forest Cover} & 2.01 $\pm$ 0.03 & \textbf{1.73 $\pm$ 0.02} & 2.01 $\pm$ 0.03 & \textbf{1.05 $\pm$ 0.01} & 2.03 $\pm$ 0.03 & \textbf{1.09 $\pm$ 0.01} \\ 
    \textbf{KDD99       } & 3.14 $\pm$ 0.08 & \textbf{0.08 $\pm$ 0.01} & 3.20 $\pm$ 0.05 & \textbf{0.05 $\pm$ 0.01} & 3.18 $\pm$ 0.07 & \textbf{0.06 $\pm$ 0.01} \\ 

    \bottomrule
    \end{tabular}
    \caption{Results with resnet and batch of 256}
    \label{tab:resultsRESNET256}
    \end{center}
    \end{footnotesize}
\end{table}


\begin{table}[h!]
    \begin{footnotesize}
    \begin{center}
    \begin{tabular}{l|cc:cc:cc}
    \toprule
    Dataset               &   SGD           & SGD \& \tecnameAbrv & Adagrad & Adagrad \& \tecnameAbrv & Adam        & Adam \& \tecnameAbrv \\
    \midrule
    \textbf{ACI         } & 0.96 $\pm$ 0.58 & \textbf{0.21 $\pm$ 0.02} & 0.98 $\pm$ 0.56 & \textbf{0.17 $\pm$ 0.03} & 0.76 $\pm$ 0.44 & 0.56 $\pm$ 0.35 \\ 
    \textbf{compas      } & 0.64 $\pm$ 0.36 & 0.46 $\pm$ 0.20 & 0.51 $\pm$ 0.36 & 0.28 $\pm$ 0.15 & 0.68 $\pm$ 0.35 & 0.63 $\pm$ 0.32 \\ 
    \textbf{DGK         } & 0.19 $\pm$ 0.06 & 0.15 $\pm$ 0.04 & 0.16 $\pm$ 0.06 & 0.11 $\pm$ 0.01 & 0.21 $\pm$ 0.12 & 0.18 $\pm$ 0.09 \\ 
    \textbf{Forest Cover} & 1.98 $\pm$ 0.02 & 1.98 $\pm$ 0.01 & 1.98 $\pm$ 0.02 & \textbf{1.85 $\pm$ 0.05} & 1.99 $\pm$ 0.02 & 1.98 $\pm$ 0.02 \\ 
    \textbf{KDD99       } & 3.17 $\pm$ 0.19 & \textbf{1.11 $\pm$ 0.24} & 3.10 $\pm$ 0.10 & \textbf{0.21 $\pm$ 0.02} & 3.11 $\pm$ 0.18 & \textbf{1.93 $\pm$ 0.41} \\ 

    \bottomrule
    \end{tabular}
    \caption{Results with mlp and batch of 512}
    \label{tab:resultsMLP512}
    \end{center}
    \end{footnotesize}
\end{table}


\begin{table}[h!]
    \begin{footnotesize}
    \begin{center}
    \begin{tabular}{l|cc:cc:cc}
    \toprule
    Dataset               &   SGD           & SGD \& \tecnameAbrv & Adagrad & Adagrad \& \tecnameAbrv & Adam        & Adam \& \tecnameAbrv \\
    \midrule
    \textbf{ACI         } & 0.40 $\pm$ 0.08 & \textbf{0.15 $\pm$ 0.01} & 0.34 $\pm$ 0.04 & \textbf{0.12 $\pm$ 0.01} & 0.38 $\pm$ 0.08 & \textbf{0.13 $\pm$ 0.01} \\ 
    \textbf{compas      } & 0.58 $\pm$ 0.14 & \textbf{0.23 $\pm$ 0.02} & 0.51 $\pm$ 0.12 & \textbf{0.04 $\pm$ 0.01} & 0.62 $\pm$ 0.20 & \textbf{0.07 $\pm$ 0.01} \\ 
    \textbf{DGK         } & 0.26 $\pm$ 0.04 & \textbf{0.17 $\pm$ 0.01} & 0.27 $\pm$ 0.06 & \textbf{0.12 $\pm$ 0.01} & 0.29 $\pm$ 0.08 & \textbf{0.13 $\pm$ 0.01} \\ 
    \textbf{Forest Cover} & 2.02 $\pm$ 0.03 & \textbf{1.86 $\pm$ 0.03} & 2.02 $\pm$ 0.04 & \textbf{1.04 $\pm$ 0.01} & 1.99 $\pm$ 0.04 & \textbf{1.08 $\pm$ 0.01} \\ 
    \textbf{KDD99       } & 3.23 $\pm$ 0.09 & \textbf{0.10 $\pm$ 0.01} & 3.20 $\pm$ 0.08 & \textbf{0.06 $\pm$ 0.01} & 3.23 $\pm$ 0.06 & \textbf{0.07 $\pm$ 0.01} \\ 

    \bottomrule
    \end{tabular}
    \caption{Results with resnet and batch of 512}
    \label{tab:resultsRESNET512}
    \end{center}
    \end{footnotesize}
\end{table}


\begin{table}[h!]
    \begin{footnotesize}
    \begin{center}
    \begin{tabular}{l|cc:cc:cc}
    \toprule
    Dataset               &   SGD           & SGD \& \tecnameAbrv & Adagrad & Adagrad \& \tecnameAbrv & Adam        & Adam \& \tecnameAbrv \\
    \midrule
    \textbf{ACI         } & 0.90 $\pm$ 0.57 & 0.30 $\pm$ 0.09 & 1.18 $\pm$ 0.54 & \textbf{0.21 $\pm$ 0.04} & 0.67 $\pm$ 0.49 & 0.57 $\pm$ 0.44 \\ 
    \textbf{compas      } & 0.56 $\pm$ 0.31 & 0.47 $\pm$ 0.22 & 0.56 $\pm$ 0.21 & 0.42 $\pm$ 0.20 & 0.68 $\pm$ 0.33 & 0.64 $\pm$ 0.31 \\ 
    \textbf{DGK         } & 0.18 $\pm$ 0.09 & 0.15 $\pm$ 0.05 & 0.25 $\pm$ 0.14 & 0.16 $\pm$ 0.07 & 0.18 $\pm$ 0.07 & 0.16 $\pm$ 0.05 \\ 
    \textbf{Forest Cover} & 1.98 $\pm$ 0.02 & 1.98 $\pm$ 0.02 & 1.99 $\pm$ 0.02 & \textbf{1.93 $\pm$ 0.02} & 1.99 $\pm$ 0.02 & 1.98 $\pm$ 0.02 \\ 
    \textbf{KDD99       } & 3.29 $\pm$ 0.13 & \textbf{1.66 $\pm$ 0.34} & 3.16 $\pm$ 0.15 & \textbf{0.21 $\pm$ 0.02} & 3.09 $\pm$ 0.11 & \textbf{2.40 $\pm$ 0.21} \\ 

    \bottomrule
    \end{tabular}
    \caption{Results with mlp and batch of 1024}
    \label{tab:resultsMLP1024}
    \end{center}
    \end{footnotesize}
\end{table}


\begin{table}[h!]
    \begin{footnotesize}
    \begin{center}
    \begin{tabular}{l|cc:cc:cc}
    \toprule
    Dataset               &   SGD           & SGD \& \tecnameAbrv & Adagrad & Adagrad \& \tecnameAbrv & Adam        & Adam \& \tecnameAbrv \\
    \midrule
    \textbf{ACI         } & 0.48 $\pm$ 0.14 & \textbf{0.18 $\pm$ 0.01} & 0.39 $\pm$ 0.05 & \textbf{0.13 $\pm$ 0.01} & 0.42 $\pm$ 0.11 & \textbf{0.13 $\pm$ 0.01} \\ 
    \textbf{compas      } & 0.59 $\pm$ 0.16 & \textbf{0.27 $\pm$ 0.01} & 0.60 $\pm$ 0.19 & \textbf{0.05 $\pm$ 0.01} & 0.72 $\pm$ 0.30 & \textbf{0.09 $\pm$ 0.02} \\ 
    \textbf{DGK         } & 0.29 $\pm$ 0.07 & \textbf{0.18 $\pm$ 0.01} & 0.25 $\pm$ 0.05 & \textbf{0.12 $\pm$ 0.01} & 0.30 $\pm$ 0.13 & \textbf{0.13 $\pm$ 0.01} \\ 
    \textbf{Forest Cover} & 2.00 $\pm$ 0.03 & \textbf{1.91 $\pm$ 0.03} & 2.02 $\pm$ 0.03 & \textbf{1.09 $\pm$ 0.01} & 2.00 $\pm$ 0.03 & \textbf{1.14 $\pm$ 0.01} \\ 
    \textbf{KDD99       } & 3.19 $\pm$ 0.09 & \textbf{0.13 $\pm$ 0.01} & 3.17 $\pm$ 0.05 & \textbf{0.05 $\pm$ 0.01} & 3.18 $\pm$ 0.05 & \textbf{0.07 $\pm$ 0.01} \\ 

    \bottomrule
    \end{tabular}
    \caption{Results with resnet and batch of 1024}
    \label{tab:resultsRESNET1024}
    \end{center}
    \end{footnotesize}
\end{table}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\subsection{Performance impact}
To implement this solution, we need to count each symbol occurrence in the batch. If well implemented, this is negligible. Especially when the data is column-oriented, you only need to \textit{group by} symbol and count them. Moreover this has no relationship with the $\theta$'s value, it can be pre-computed and reused at every epoch if the training dataset stay static through steps.




%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%
